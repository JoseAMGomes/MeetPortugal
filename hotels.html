<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.1.1/css/hover-min.css"
        type="text/css" />

    <link rel="stylesheet" href="assets/css/style.css">

    <title>MeetPortugal</title>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

</head>

<body>

    <div class="big-image">

        <!--NAV  -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="index.html"><span class="logo">Meet Portugal</span></a>
            <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">


                    <li class="nav-item">
                        <a class="nav-item cities" href="porto.html">Porto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-item cities" href="lisboa.html">Lisboa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-item cities" href="algarve.html">Algarve</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-item cities" href="madeira.html">Madeira</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-item cities" href="hotels.html">Hotels</a>
                    </li>
                </ul>

            </div>
        </nav>

    </div>
    <section class="row content-section no-gutters">
        <h1 class="col-12 title">Hotels</h1>
        <div class="col-lg-12 ">
            <div id="map">

            </div>
        </div>
    </section>

    <footer>
        <h2>CONTACT</h2>
        <p>Email: j.a.m.gomes.work@gmail.com</p>
    </footer>
    <script>
        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: {
                    lat: 39.4,
                    lng: -8.2
                },

                zoom: 6,
                mapTypeControl: false,
                panControl: false,
                streetViewControl: false,

            });

            function onPlaceChanged() {
                const place = autocomplete.getPlace();

                if (place.geometry && place.geometry.location) {
                    map.panTo(place.geometry.location);
                    map.setZoom(15);
                    search();
                } else {
                    document.getElementById("autocomplete").placeholder = "Enter a city";
                }
            }

            // Search for hotels in the selected city, within the viewport of the map.
            function search() {
                const search = {
                    bounds: map.getBounds(),
                    types: ["lodging"],
                };
                places.nearbySearch(search, (results, status, pagination) => {
                    if (status === google.maps.places.PlacesServiceStatus.OK && results) {
                        clearResults();
                        clearMarkers();

                        // Create a marker for each hotel found, and
                        // assign a letter of the alphabetic to each marker icon.
                        for (let i = 0; i < results.length; i++) {
                            const markerLetter = String.fromCharCode("A".charCodeAt(0) + (i % 26));
                            const markerIcon = MARKER_PATH + markerLetter + ".png";
                            // Use marker animation to drop the icons incrementally on the map.
                            markers[i] = new google.maps.Marker({
                                position: results[i].geometry.location,
                                animation: google.maps.Animation.DROP,
                                icon: markerIcon,
                            });
                            // If the user clicks a hotel marker, show the details of that hotel
                            // in an info window.
                            markers[i].placeResult = results[i];
                            google.maps.event.addListener(markers[i], "click", showInfoWindow);
                            setTimeout(dropMarker(i), i * 100);
                            addResult(results[i], i);
                        }
                    }
                });
            }

            function clearMarkers() {
                for (let i = 0; i < markers.length; i++) {
                    if (markers[i]) {
                        markers[i].setMap(null);
                    }
                }
                markers = [];
            }

            // Set the country restriction based on user input.
            // Also center and zoom the map on the given country.
            function setAutocompleteCountry() {
                const country = document.getElementById("country").value;

                if (country == "all") {
                    autocomplete.setComponentRestrictions({
                        country: []
                    });
                    map.setCenter({
                        lat: 15,
                        lng: 0
                    });
                    map.setZoom(2);
                } else {
                    autocomplete.setComponentRestrictions({
                        country: country
                    });
                    map.setCenter(countries[country].center);
                    map.setZoom(countries[country].zoom);
                }
                clearResults();
                clearMarkers();
            }

            function dropMarker(i) {
                return function () {
                    markers[i].setMap(map);
                };
            }

            function addResult(result, i) {
                const results = document.getElementById("results");
                const markerLetter = String.fromCharCode("A".charCodeAt(0) + (i % 26));
                const markerIcon = MARKER_PATH + markerLetter + ".png";
                const tr = document.createElement("tr");
                tr.style.backgroundColor = i % 2 === 0 ? "#F0F0F0" : "#FFFFFF";

                tr.onclick = function () {
                    google.maps.event.trigger(markers[i], "click");
                };
                const iconTd = document.createElement("td");
                const nameTd = document.createElement("td");
                const icon = document.createElement("img");
                icon.src = markerIcon;
                icon.setAttribute("class", "placeIcon");
                icon.setAttribute("className", "placeIcon");
                const name = document.createTextNode(result.name);
                iconTd.appendChild(icon);
                nameTd.appendChild(name);
                tr.appendChild(iconTd);
                tr.appendChild(nameTd);
                results.appendChild(tr);
            }

            function clearResults() {
                const results = document.getElementById("results");

                while (results.childNodes[0]) {
                    results.removeChild(results.childNodes[0]);
                }
            }

            // Get the place details for a hotel. Show the information in an info window,
            // anchored on the marker for the hotel that the user selected.
            function showInfoWindow() {
                const marker = this;
                places.getDetails({
                        placeId: marker.placeResult.place_id
                    },
                    (place, status) => {
                        if (status !== google.maps.places.PlacesServiceStatus.OK) {
                            return;
                        }
                        infoWindow.open(map, marker);
                        buildIWContent(place);
                    }
                );
            }

            // Load the place information into the HTML elements used by the info window.
            function buildIWContent(place) {
                document.getElementById("iw-icon").innerHTML =
                    '<img class="hotelIcon" ' + 'src="' + place.icon + '"/>';
                document.getElementById("iw-url").innerHTML =
                    '<b><a href="' + place.url + '">' + place.name + "</a></b>";
                document.getElementById("iw-address").textContent = place.vicinity;

                if (place.formatted_phone_number) {
                    document.getElementById("iw-phone-row").style.display = "";
                    document.getElementById("iw-phone").textContent =
                        place.formatted_phone_number;
                } else {
                    document.getElementById("iw-phone-row").style.display = "none";
                }

                // Assign a five-star rating to the hotel, using a black star ('&#10029;')
                // to indicate the rating the hotel has earned, and a white star ('&#10025;')
                // for the rating points not achieved.
                if (place.rating) {
                    let ratingHtml = "";

                    for (let i = 0; i < 5; i++) {
                        if (place.rating < i + 0.5) {
                            ratingHtml += "&#10025;";
                        } else {
                            ratingHtml += "&#10029;";
                        }
                        document.getElementById("iw-rating-row").style.display = "";
                        document.getElementById("iw-rating").innerHTML = ratingHtml;
                    }
                } else {
                    document.getElementById("iw-rating-row").style.display = "none";
                }

                // The regexp isolates the first part of the URL (domain plus subdomain)
                // to give a short URL for displaying in the info window.
                if (place.website) {
                    let fullUrl = place.website;
                    let website = String(hostnameRegexp.exec(place.website));

                    if (!website) {
                        website = "http://" + place.website + "/";
                        fullUrl = website;
                    }
                    document.getElementById("iw-website-row").style.display = "";
                    document.getElementById("iw-website").textContent = website;
                } else {
                    document.getElementById("iw-website-row").style.display = "none";
                }
            }

        }
    </script>
    <script src="https://unpkg.com/@googlemaps/markerclustererplus/dist/index.min.js"></script>
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC5nYoKB2F7jNqjo1oe7Ips5uTPaCmvGFA&callback=initMap&libraries=&v=weekly"
        async>
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous">
    </script>
    <script src="index.js"></script>


</body>

</html>